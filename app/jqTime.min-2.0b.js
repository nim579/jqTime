// Plugin jqTime. Printing current time in selector.
// Aunthor: Ivanushkin Nikolay (Nim579). Sorced 29.04.2011
// Promo: http://nim579.ru/promo/jqtime.html
// Documentation: http://nim579.ru/html/jqtime.html (http://nim579.ru/dev/jqtime.html)
// Version: 2.0b (Sat Nov 17 2012 14:07:14)
var jqTimeProc={returnString:function(e,t,n,r,i){var s="",o=new Array;e=e.toLowerCase(),e.indexOf("h")>=0&&(o[e.indexOf("h")]=n),e.indexOf("m")>=0&&(o[e.indexOf("m")]=r),e.indexOf("s")>=0&&(o[e.indexOf("s")]=i);for(var u in o)u==o.length-1?s+=o[u]:s+=o[u]+t;return s},formater:function(e){return isFinite(e)&&e.length>0&&(e=Number(e),e<=9&&(e="0"+e)),e},updater:function(var_i,utc){if(var_i%300==0){var today=new Date;var_i=3600*today.getHours()+60*today.getMinutes()+today.getSeconds(),utc!="real"&&(var_i+=eval(today.getTimezoneOffset()*60+utc*3600))}return var_i},sting_to_time:function(e){if(e!=undefined){e=e.split(":");var t=0,n=2;for(var r=0;r<e.length;r++)t+=Number(e[r])*Math.pow(60,n),n--;return t}return undefined},exp_to_time:function(e){var e=e.replace(/([h]+)/g,hou),e=e.replace(/([H]+)/g,jqTimeProc.formater(hou)),e=e.replace(/([m]+)/g,min),e=e.replace(/([M]+)/g,jqTimeProc.formater(min)),e=e.replace(/([s]+)/g,sec),e=e.replace(/([S]+)/g,jqTimeProc.formater(sec));return e}};$.fn.curTime=function(options){var options=$.extend({sepor:":",wrap:!1,format:!0,utc:"real",template:"hms",exp:null},options),elements=this,today=new Date,i=3600*today.getHours()+60*today.getMinutes()+today.getSeconds();options.utc!="real"&&(i+=eval(today.getTimezoneOffset()*60+options.utc*3600)),setInterval(function(){i++,i%=86400,w=i,w<0&&(w=86400+w),options.wrap&&(w=86400-w),hou=Math.floor(w/3600),min=Math.floor((w-hou*3600)/60),sec=Math.floor(w-hou*3600-min*60),options.format&&(hou=jqTimeProc.formater(hou),min=jqTimeProc.formater(min),sec=jqTimeProc.formater(sec));if(options.exp!=null)var e=jqTimeProc.exp_to_time(options.exp);else var e=jqTimeProc.returnString(options.template,options.sepor,hou,min,sec);$(elements).text(e),i=jqTimeProc.updater(i,options.utc)},1e3)},jQuery.fn.intervalTimer=function(options){var options=jQuery.extend({sepor:":",wrap:!0,format:!0,utc:"real",template:"hms",exp:"",timeFrom:"",timeTo:"",alt:""},options),elements=this,today=new Date,i=3600*today.getHours()+60*today.getMinutes()+today.getSeconds();options.utc!="real"&&(i+=eval(today.getTimezoneOffset()*60+options.utc*3600));var iFrom=jqTimeProc.sting_to_time(options.timeFrom),iTo=jqTimeProc.sting_to_time(options.timeTo),c=i;setInterval(function(){i++,i%=86400;if(options.wrap)if(iFrom<=iTo)if(i>=iFrom&&i<=iTo)var e=iTo-i;else var e=-1;else if(i>=iFrom&&i<=86400||i>=0&&i<=iTo)var e=(86400+iTo-i)%86400;else var e=-1;else if(iFrom>=iTo)if(i>=iFrom&&i<=86400||i<=iTo&&i>=0)var e=i;else var e=-1;else if(i=iFrom&&i<=iTo)e=i;else var e=-1;if(e+1){hou=Math.floor(e/3600),min=Math.floor((e-hou*3600)/60),sec=Math.floor(e-hou*3600-min*60),options.format&&(hou=jqTimeProc.formater(hou),min=jqTimeProc.formater(min),sec=jqTimeProc.formater(sec));if(options.exp!=null)var t=jqTimeProc.exp_to_time(options.exp);else var t=jqTimeProc.returnString(options.template,options.sepor,hou,min,sec);$(elements).text(t)}else $(elements).html(options.alt);i=jqTimeProc.updater(i,options.utc)},1e3)},jQuery.fn.timeToggler=function(options){function ev_listener(e){e!=o_ev&&(e?options.inInterval==null?$(elements).html(el_html).show():$(elements).html(options.inInterval):options.outInterval==null?$(elements).hide():$(elements).html(options.outInterval),o_ev=e)}var options=$.extend({timeFrom:"",timeTo:"",inInterval:null,outInterval:null,utc:"real"},options),elements=this,el_html=$(elements).html(),today=new Date,i=3600*today.getHours()+60*today.getMinutes()+today.getSeconds();options.utc!="real"&&(i+=eval(today.getTimezoneOffset()*60+options.utc*3600));var iFrom=jqTimeProc.sting_to_time(options.timeFrom),iTo=jqTimeProc.sting_to_time(options.timeTo);setInterval(function(){i++;if(iFrom<=iTo)if(i>=iFrom&&i<iTo)var e=!0;else var e=!1;else if(i>=iFrom&&i<=86400||i>=0&&i<iTo)var e=!0;else var e=!1;ev_listener(e),i=jqTimeProc.updater(i,options.utc)},1e3);var o_ev=null};